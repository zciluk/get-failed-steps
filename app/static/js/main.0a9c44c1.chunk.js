(this["webpackJsonpfailed-artifacts"]=this["webpackJsonpfailed-artifacts"]||[]).push([[0],{151:function(e,t,a){e.exports=a(292)},292:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(29),c=a.n(l),o=a(82),i=a.n(o),u=a(141),s=a(41),d=a(26),m=a(140),p=a(303),b=a(304),h=a(138),f=a(302),E=(a(157),a(129)),g=a.n(E).a.create({baseURL:"https://gitlab.com/api/v4//"}),j=a(83),D=a(55);function y(){var e=Object(j.a)(["\n  display: block;\n  padding: 2rem;\n  margin: 4rem;\n  border: 1rem solid #cccccc;\n  border-left-color: #777777;\n  border-radius: 50%;\n  width: 5rem;\n  height: 5rem;\n  animation: "," 1.2s linear infinite;\n"]);return y=function(){return e},e}function v(){var e=Object(j.a)(["\nfrom {\n    transform: rotate(0deg);\n  }\n\n  to {\n    transform: rotate(360deg);\n  }\n"]);return v=function(){return e},e}var O=Object(D.b)(v()),I=D.a.div(y(),O),P=function(){return r.a.createElement(I,null)},N=a(301),C=function(e){var t=e.displayedData;return r.a.createElement(N.a,{collapsing:!0,color:"teal"},r.a.createElement(N.a.Header,null,r.a.createElement(N.a.Row,null,r.a.createElement(N.a.HeaderCell,null,"Name of test"),r.a.createElement(N.a.HeaderCell,null,"Number of Fails"))),r.a.createElement(N.a.Body,null,t.filter((function(e,t,a){return a.indexOf(e)===t})).map((function(e){return r.a.createElement(N.a.Row,null,r.a.createElement(N.a.Cell,null,e),r.a.createElement(N.a.Cell,null,t.filter((function(t){return t===e})).length))}))))},k=a(299),w=a(293),H=function(e){var t=e.projectID,a=e.apiKey,n=e.selectedDate,l=e.handleChange,c=e.searchCall,o=e.startHour,i=e.endHour;return r.a.createElement(p.a,{inverted:!0,color:"teal"},r.a.createElement(b.a,{divided:"vertically"},r.a.createElement(b.a.Row,{columns:3},r.a.createElement(h.a,null,r.a.createElement(k.a,{icon:"gitlab",name:"projectID",value:t,onChange:l,placeholder:"Project ID",label:{basic:!0,content:"Project ID"},labelPosition:"left"})),r.a.createElement(h.a,null,r.a.createElement(k.a,{icon:"key",name:"apiKey",type:"password",value:a,onChange:l,placeholder:"API key",label:{basic:!0,content:"API key"},labelPosition:"left"})),r.a.createElement(h.a,null,r.a.createElement(k.a,{icon:"clock",name:"selectedDate",value:n,onChange:l,placeholder:"Selected Day",label:{basic:!0,content:"Day to check"},labelPosition:"left",type:"date"}))),r.a.createElement(b.a.Row,{columns:"3"},r.a.createElement(h.a,null,r.a.createElement(w.a,{onClick:c,color:"black"},"Get results")),r.a.createElement(h.a,null,r.a.createElement(k.a,{icon:"clock",name:"startHour",value:o,onChange:l,placeholder:"From hour",label:{basic:!0,content:"From hour"},labelPosition:"left",type:"time"})),r.a.createElement(h.a,null,r.a.createElement(k.a,{icon:"clock",name:"endHour",value:i,onChange:l,placeholder:"Till hour",label:{basic:!0,content:"Till hour"},labelPosition:"left",type:"time"})))))};var K=function(){var e=new URLSearchParams(window.location.search),t=Object(n.useState)({displayedData:"",apiKey:Object({NODE_ENV:"production",PUBLIC_URL:"/get-failed-steps/app"}).REACT_APP_API_KEY,projectID:e.get("projectId"),isError:!1,selectedDate:(new Date).toISOString().substring(0,10),isSearching:!1,pipelinesNumber:null,jobsNumber:null,testFailsNumber:null,dateOfCheck:null,startHour:"00:00",endHour:"23:59"}),a=Object(m.a)(t,2),l=a[0],c=a[1],o=function(e){var t=[],a=[];e.forEach((function(e){a.push(g.get("/projects/".concat(l.projectID,"/pipelines/").concat(e.id,"/jobs"),{headers:{"PRIVATE-TOKEN":l.apiKey}}).then((function(e){e.data.forEach((function(e){t.push(e.id)}))})).catch((function(e){console.log("Error retrieving pipeline jobs data")})))})),Promise.all(a).then((function(){E(t),c((function(e){return Object(d.a)({},e,{jobsNumber:t.length})}))}))},E=function(e){var t=[],a=[],n=/(?<=Failed Step: ).*?\n/g;e.forEach((function(e){a.push(g.get("/projects/".concat(l.projectID,"/jobs/").concat(e,"/trace"),{headers:{"PRIVATE-TOKEN":l.apiKey}}).then((function(e){var a;return i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=e.data.match(n),console.log(a),null===a){r.next=5;break}return r.next=5,i.a.awrap(t.push.apply(t,Object(u.a)(a)));case 5:case"end":return r.stop()}}))})).catch((function(e){console.log("Error retrieving trace from jobs")})))})),Promise.all(a).then((function(){c((function(e){return Object(d.a)({},e,{isError:!1,isSearching:!1,displayedData:t,testFailsNumber:t.length})}))}))};return r.a.createElement(p.a,null,r.a.createElement(H,{projectID:l.projectID,apiKey:l.apiKey,selectedDate:l.selectedDate,handleChange:function(e){var t=e.target,a=t.name,n=t.value;c("selectedDate"===a?function(e){return Object(d.a)({},e,Object(s.a)({},a,n.substring(0,10)))}:function(e){return Object(d.a)({},e,Object(s.a)({},a,n))})},searchCall:function(e){c((function(e){return Object(d.a)({},e,{isSearching:!0,isError:!1,pipelinesNumber:null,jobsNumber:null,testFailsNumber:null,dateOfCheck:l.selectedDate})}));var t=new Date(l.selectedDate);return t.setDate(t.getDate()+1),g.get("/projects/".concat(l.projectID,"/pipelines?updated_after=").concat(l.selectedDate,"T").concat(l.startHour,":00Z&order_by=updated_at&sort=asc&updated_before=").concat(t,"T").concat(l.endHour,":00Z"),{headers:{"PRIVATE-TOKEN":l.apiKey}}).then((function(e){o(e.data),c((function(t){return Object(d.a)({},t,{pipelinesNumber:e.data.length})}))})).catch((function(e){c((function(e){return Object(d.a)({},e,{isError:!0,isSearching:!1})}))}))},startHour:l.startHour,endHour:l.endHour}),r.a.createElement(b.a,{columns:"equal"},r.a.createElement(h.a,{width:"8"},!l.isError&&!l.isSearching&&0!==l.displayedData.length&&r.a.createElement(C,{displayedData:l.displayedData}),l.isError&&r.a.createElement(f.a,{negative:!0},r.a.createElement(f.a.Header,null,"There was an error while doing API request. Check if API key/Project ID is correct.")),l.isSearching&&r.a.createElement(P,null)),r.a.createElement(h.a,{width:"4"},!l.isError&&null!==l.pipelinesNumber&&r.a.createElement(f.a,null,r.a.createElement("p",null,"Check for date: ",l.dateOfCheck," "),r.a.createElement("p",null,"Pipelines retrieved: ",l.pipelinesNumber," "),null!==l.jobsNumber&&r.a.createElement("p",null," Jobs retrieved: ",l.jobsNumber," "),null!==l.testFailsNumber&&r.a.createElement("p",null," Failed steps: ",l.testFailsNumber," ")))))};c.a.render(r.a.createElement(K,null),document.getElementById("root"))}},[[151,1,2]]]);
//# sourceMappingURL=main.0a9c44c1.chunk.js.map